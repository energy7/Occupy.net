<!doctype html>
<html lang="en">
<head>
  
  <meta charset="utf-8" />
  <title>The Occupy Network</title>
  
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
  <link rel="stylesheet" href="css/style.css" />
  
  <!-- scripts at bottom of page -->

</head>
<body class="homepage">
  
<script type="text/javascript" src="http://nav.occupy.net/occupynet_nav.js"></script>

<section id="content">


<section id="options" class="clearfix">
	<div class="option-logo">
		<h1>the <span class="occupy">occupy</span> network</h1>
	</div>
	<div class="option-combo">
	  <h3>Sort by:</h3>
	  <ul id="sort" class="option-set clearfix" data-option-key="sortBy">
	    <li><a href="#mixed" data-option-value="number" class="selected">mixed</a></li>
	    <li><a href="#original" data-option-value="date">date</a></li>
	    <li><a href="#alphabetical" data-option-value="alphabetical">name</a></li>
	  </ul>
	</div>
	<div class="option-combo">
	  <h3>Show:</h3>
	  <ul id="filter" class="option-set clearfix" data-option-key="filter">
	    <li><a href="#show-all" data-option-value="*" class="selected">all</a></li>
	    <li><a href="#events" data-option-value=".event, .campaign">events</a></li>
	    <li><a href="#knowledge" data-option-value=".wiki, .info">knowledge</a></li>
	    <li><a href="#news" data-option-value=".news, .photo, .directory">news</a></li>
	    <li><a href="#opportunities" data-option-value=".classified">opportunities</a></li>
	    <li><a href="#tools" data-option-value=".project">tools</a></li>
	  </ul>
	</div>
</section>


<div id="container" class="clearfix">
	
	<div class="info" data-number="1">
		<h5 class="title">Welcome</h5>
		<p class="text">Occupy.net provides people with software tools that align with the values of the #occupy movement. All of the tools offered through Occupy.net are free/libre/open source: part of the global information commons, maintained by communities, not corporations.<br><br>Would you like to provide or help maintain an open source tool for this network?</p>
	</div>
	
	<div class="info" data-number="5">
		<h5 class="title">What is Occupy?</h5>
		<p class="text">It's more than just peaceful assemblies. When we occupy a space, or a topic, we spotlight it. We encourage people to investigate, understand, act, and change something.<br><br>What do you want to occupy?<br><br><b>Coming up: Occupy May Day</b></p>
	</div>

	  
	<div class="project" data-number="10">
		<img class="icon" src="img/icons/wiki.png">
		<h3 class="title">Wiki</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="11">
		<img class="icon" src="img/icons/map.png">
		<h3 class="title">Map</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="12">
		<img class="icon" src="img/icons/notes.png">
		<h3 class="title">Notes</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="13">
		<img class="icon" src="img/icons/events.png">
		<h3 class="title">Events</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="14">
		<img class="icon" src="img/icons/campaigns.png">
		<h3 class="title">Campaigns</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="33">
		<img class="icon" src="img/icons/forum.png">
		<h3 class="title">Forum</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="16">
		<img class="icon" src="img/icons/ideas.png">
		<h3 class="title">Ideas</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="17">
		<img class="icon" src="img/icons/lists.png">
		<h3 class="title">Lists</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="18">
		<img class="icon" src="img/icons/news.png">
		<h3 class="title">News</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project"  data-number="19">
		<img class="icon" src="img/icons/classifieds.png">
		<h3 class="title">Classifieds</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="20">
		<img class="icon" src="img/icons/directory.png">
		<h3 class="title">Directory</h3>
		<h5 class="status">alpha</h5>
	</div>
	<div class="project" data-number="21" data-full="inline1">
		<img class="icon" src="img/icons/search.png">
		<h3 class="title">Search</h3>
		<h5 class="status">alpha</h5>
	</div>
</div>


<div id="feeds" style="display:none">
  <!--use semantic markup to define your feeds as data 
  jquery $("#feeds").find(".feed") turns this html into
  var feeds  = [{
    'url': 'http://feeds....',
    'type': 'news',
  },
  {
    'url': 'http://map.occupy.net',
    'type': 'map',
  }
  ]
and so on - an array of objects with "url" and "type" attributes  
  -->
  <div class="feed">
    <div class="url">http://feeds.feedburner.com/interoccupy</div>
    <div class="type">news</div>
  </div>
  <div class="feed">
    <div class="url">http://classifieds.occupy.net/rss/all/</div>
    <div class="type">classified</div>
  </div>
  <div class="feed">
    <div class="url">http://wearethe99percent.tumblr.com/rss</div>
    <div class="type">photo</div>
  </div>
  <div class="feed">
    <div class="url">http://wiki.occupy.net/wiki/Special:NewsFeed?feed=rss&categories=Featured</div>
    <div class="type">wiki</div>
  </div>
  <div class="feed">
    <div class="url">http://directory.occupy.net/occupations/added.rss</div>
    <div class="type">directory</div>
  </div>
  <div class="feed">
    <div class="url">http://map.occupy.net/feed/</div>
    <div class="type">map</div>
  </div>  
  <div class="feed">
    <div class="url">http://campaigns.occupy.net/feed/</div>
    <div class="type">campaign</div>
  </div>
  <div class="feed">
    <div class="url">http://newswire.occupy.net/channel/368/rss.xml</div>
    <div class="type">news</div>
  </div>
</div>



<!-- jquery -->
<script src="js/jquery-1.7.1.min.js"></script>
<script src="https://www.google.com/jsapi"></script>
<script src="js/jquery.isotope.min.js"></script>


<!-- feed reader -->
<script type="text/javascript">
var $container = $('#container');
var feeds = google.load("feeds", "1");
google.setOnLoadCallback(function() {
  // First, set up click on tile => Shadowbox for pre-existing static tiles
  $('#container div').click( activateTile );

  $(function() {
 
  
  //grab your data from the html (semantic markup)
  $("#feeds").find(".feed").each(function(j,e){
    //extract url from html
    var url = $(e).find(".url").html();
	  var feed = new google.feeds.Feed(url);
	  var num = 3;
    //extract type from html
	  var type = $(e).find(".type").html();
	  feed.setNumEntries(num);
	  feed.load(function(result) {
	    if (!result.error) {
	      var container = document.getElementById("container");
	      for (var i = 0; i < result.feed.entries.length; i++) {
	        var entry = result.feed.entries[i];
	
	        var div = document.createElement("div");
	        
	        // Construct contents of new <div> element for this item.
	        $(div).addClass(type);
	        $(div).addClass("feed-item");
	        
	        // <div><h3 class="title">...</h3></div>
	        var title = div.appendChild(document.createElement("h3"));
	        title.className = "title";
	        title.appendChild(document.createTextNode(entry.title));
	
	        // <div> ... <p class="date">...</p></div>
	        var date = div.appendChild(document.createElement("p"));
	        $(date).addClass("date");
	        
		var entryDate = new Date(entry.publishedDate);
		var pubDate = entryDate.toLocaleDateString();
	        date.appendChild(document.createTextNode(pubDate));
	
	        // <div> ... <div class="description"> ... </div> </div>
	        // This needs to be a <div> because the item content may include
	        // block-level HTML tags, and hence cannot fit inside a <p>
	        
	        var description = div.appendChild(document.createElement("div"));
	        description.className = "description";
	        description.innerHTML = entry.content;
	        
	        var divInDOM = container.appendChild(div);
	        
	        // Clicking this sends the tile to the Shadowbox
	        $(divInDOM).click( activateTile );
	      };
	    };
	    $container.isotope('insert',$(".feed-item"))
    
  	
	  
	  });
    
  })

	  	  

	  //endfor
  });
});


//ISOTOPE 
$(document).ready(function(){
  // adding 'insert' here includes the feeds but breaks the sort
  $container.isotope({
    masonry: {
      columnWidth: 120
    },
    getSortData: {
      number: function( $elem ) {
        var number = $elem.hasClass('element') ? 
          $elem.find('.date').text() :
          $elem.attr('data-number');
        return parseInt( number, 10 );
      },
      alphabetical: function( $elem ) {
        var name = $elem.find('.title'),
            itemText = name.length ? name : $elem;
        return itemText.text();
      }
    },
    sortBy: 'number'
  });

 //$container.isotope('insert',$(".feed-items"));


  var $optionSets = $('#options .option-set'),
      $optionLinks = $optionSets.find('a');

  $optionLinks.click(function(){
    var $this = $(this);
    // don't proceed if already selected
    if ( $this.hasClass('selected') ) {
      return false;
    }
    //toggle "selected classes"
    var $optionSet = $this.parents('.option-set');
    $optionSet.find('.selected').removeClass('selected');
    $this.addClass('selected');

    // make option object dynamically, i.e. { filter: '.my-filter-class' }
    var options = {},
      key = $optionSet.attr('data-option-key'),
      value = $this.attr('data-option-value');
    // parse 'false' as false boolean
    value = value === 'false' ? false : value;
    options[ key ] = value;
    if ( key === 'layoutMode' && typeof changeLayoutMode === 'function' ) {
      // changes in layout modes need extra logic
      changeLayoutMode( $this, options )
    } else {
      // otherwise, apply new options
      $container.isotope( options );
    }

    return false;
  });

  
})

</script>



<!-- shadowbox -->

<script src="shadowbox-3.0.3/shadowbox.js"></script>
<script>

Shadowbox.init({
    skipSetup: true
});

function activateTile () {
	var tile = $(this);
	
	// By default, we will display the contents of this <div> in the
	// lightbox.
	var player = 'html'; // Default
	var content = '<div id="layer">' + tile.html() + '</div>'; // Default
	
	// We can use HTML classes to determine what exactly we should be
	// feeding to Shadowbox.

	// if (tile.is('.photo')) {
	//	content = ...
	//	player = ...
	// } else if (tile.is('.info')) {
	// 	...
	// } else if (tile.is('.project')) {
	//	...
	// } /* if */
	
	Shadowbox.open({
	content: content,
	player: player,
	height: 400,
	width: 600
	});
}

</script>



<footer>
  Brought to you by <a href="http://nycga.net">Occupy Tech</a>
</footer>

</section> <!-- #content -->
  

</body>
</html>